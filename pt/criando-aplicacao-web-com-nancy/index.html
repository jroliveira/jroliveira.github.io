<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="Cache-Control" content="max-age=604800"><title>Criando aplicação web com Nancy ~ Junior Oliveira</title><meta name="viewport" content="width=device-width"><meta name="author" content="Junior Oliveira"><meta name="title" content="Criando aplicação web com Nancy ~ Junior Oliveira"><meta name="description" content="Post sobre Nancy, o que é, como funciona, quais as vantagens como instalar, como usar e uns exemplos iniciais."><meta name="keywords" content="csharp,nancy"><meta name="robots" content="index, follow"><meta name="theme-color" content="#C1A8B2"><meta property="og:type" content="article"><meta property="og:site_name" content="Junior Oliveira"><meta property="og:url" content="https://jroliveira.net"><meta property="og:title" content="Criando aplicação web com Nancy ~ Junior Oliveira"><meta property="og:description" content="Post sobre Nancy, o que é, como funciona, quais as vantagens como instalar, como usar e uns exemplos iniciais."><link rel="icon" href="/assets/images/favicon.png" async><link rel="manifest" href="/manifest.json" async><link rel="stylesheet" href="/assets/styles/main.css" async><link rel="stylesheet" href="/assets/styles/fontawesome.6cb5a8.css"><script async defer>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-11448040-10","auto"),ga("send","pageview")</script><script async defer rel="preconnect" src="https://www.google-analytics.com/analytics.js"></script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/feed.xml" title="Junior Oliveira" type="application/rss+xml">
</head><body><header class="site-header"><div class="page__container"><a class="site-branding" href="/"><img class="site-branding__logo" src="/assets/images/favicon.svg" alt="Junior Oliveira's blog"><h1 class="site-branding__title--full">Junior Oliveira</h1><h1 class="site-branding__title--short">Jr Oliveira</h1></a><ul class="menu"><li class="menu-item"><a class="menu-item__icon" href="/x-wing" title="Star Wars: X-Wing"><i class="xf xf-coordinate"></i></a></li><li class="menu-item"><small>&nbsp; | &nbsp;</small></li><li class="menu-item"><a class="menu-item__icon fas fa-search" href="/search" title="Pesquisar posts"></a></li></ul></div></header><main class="site-main"><div class="page__container"><article><h2 class="page__title">Criando aplicação web com Nancy<p class="post__meta"><small>8 de novembro de 2015 </small><small>&nbsp; | &nbsp;</small> <small><i class="fas fa-comments"></i>&nbsp; <a href="#disqus_thread"></a> </small><small>&nbsp; | &nbsp;</small> <small><i class="fas fa-tags"></i>&nbsp; <a href="/tags/csharp/">csharp</a> <a href="/tags/nancy/">nancy</a> </small><small>&nbsp; | &nbsp;</small> <small><i class="fas fa-globe"></i>&nbsp; <a class="text--uppercase" href="/pt/criando-aplicacao-web-com-nancy/">pt</a></small></p></h2><div class="page__content"><p>Olá pessoal, hoje eu vou falar um pouco sobre <a href="http://nancyfx.org/" target="_blank" rel="external noopener">Nancy</a>.</p><span id="more"></span><p><strong>O que é?</strong></p><p>É um framework leve e simples para construção serviços <strong>HTTP</strong> usando tecnologia <strong>.Net</strong> e <strong>Mono</strong>, e fornece uma <strong>Domain Specific Language (DSL)</strong> para devolver uma resposta de forma simples.<br>Foi projetada para rodar em qualquer lugar, já que ela possui seus próprios objetos de solicitação e resposta.<br>Um dos conceitos fundamentais em Nancy são os hosts. Um host atua como um adaptador para um ambiente de hospedagem, permitindo assim que ela possa ser executada com as tecnologias existentes, como <strong>ASP.NET</strong>, <strong>WCF</strong> e <strong>Owin</strong>, ou integrado em qualquer aplicação.<br>Nancy é um projeto open source, hospedado no GitHub e está licenciado sob a <strong>MIT license</strong>.</p><p><strong>Como instalar?</strong></p><p>Você pode instalar via NuGet, segue a <a href="https://www.nuget.org/profiles/nancyfx" target="_blank" rel="external noopener">lista dos pacotes</a> oficiais da Nancy.<br>Se você vai usar sobre ASP.NET por exemplo, você pode executar o comando abaixo no <strong>Package Manager Console</strong> do Visual Studio.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Install-Package Nancy.Hosting.Aspnet</span><br></pre></td></tr></table></figure><p><strong>Qual problema resolve?</strong></p><ul><li>Não precisa de muitas configurações, ela já vem com algumas definidas.</li><li>Para adicionar um novo módulo, geralmente é só implementar uma interface e ela já injeta para você via reflection.</li><li>Existem muitos módulos separados já criados, por exemplo, para trocar o IoC padrão é só instalar o novo e configurar no Boostrapper.</li></ul><p>Com Nancy você precisa se preocupar mais em criar seu aplicativo do que ficar criando código de configuração.</p><p><strong>Alguns exemplos</strong></p><p>Agora vamos criar nosso primeiro exemplo.<br>No Visual Studio na tela de <strong>New Project</strong>, escolha a versão <strong>.NET Framework 4.5</strong>, depois crie um projeto <strong>ASP.NET Empty Web Application</strong>.<br>No <strong>Package Manager Console</strong>, rode o comando <strong>Install-Package Nancy.Hosting.Aspnet</strong>.<br>Agora crie uma classe com o código abaixo.</p><figure class="highlight csharp"><figcaption><span>HomeModule.cs</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">HomeModule</span> : <span class="title">NancyModule</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HomeModule</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Get[<span class="string">&quot;/&quot;</span>] = _ =&gt; <span class="string">&quot;I&#x27;m working...&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Agora se você rodar a aplicação irá imprimir no navegador.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">I&#x27;m working...</span><br></pre></td></tr></table></figure><p>Para receber uma informação passada na <strong>Query String</strong> é bem simples segue um exemplo abaixo.</p><figure class="highlight csharp"><figcaption><span>AccountsModule.cs</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">AccountsModule</span> : <span class="title">NancyModule</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">AccountsModule</span>()</span></span><br><span class="line"><span class="function">        : <span class="title">base</span>(<span class="params"><span class="string">&quot;accounts&quot;</span></span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Get[<span class="string">&quot;/&#123;id&#125;&quot;</span>] = parameters =&gt; GetById(parameters.id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Response <span class="title">GetById</span>(<span class="params"><span class="built_in">int</span> id</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> response = <span class="keyword">new</span></span><br><span class="line">        &#123;</span><br><span class="line">            id,</span><br><span class="line">            name = <span class="string">&quot;Júnior&quot;</span></span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Response.AsJson(response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Se você for ao navegador e digitar <strong>&#x2F;accounts&#x2F;25</strong> ele irá imprimir o json abaixo.</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">id</span>: <span class="number">25</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;Júnior&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Recebendo os dados de uma requisição <strong>POST</strong>.<br>Note no código que eu usei o código <strong>this.Bind()</strong> para fazer o de para dos dados enviados para a minha classe <strong>AccountModel</strong>.<br>Depois eu apenas gerei um Id randômico e respondi o id fake gerado.</p><figure class="highlight csharp"><figcaption><span>AccountsModule.cs</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">AccountsModule</span> : <span class="title">NancyModule</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">AccountsModule</span>()</span></span><br><span class="line"><span class="function">        : <span class="title">base</span>(<span class="params"><span class="string">&quot;accounts&quot;</span></span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Get[<span class="string">&quot;/&#123;id&#125;&quot;</span>] = parameters =&gt; GetById(parameters.id);</span><br><span class="line">        Post[<span class="string">&quot;/&quot;</span>] = _ =&gt; Create(<span class="keyword">this</span>.Bind&lt;AccountModel&gt;());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Response <span class="title">GetById</span>(<span class="params"><span class="built_in">int</span> id</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> response = <span class="keyword">new</span></span><br><span class="line">        &#123;</span><br><span class="line">            id,</span><br><span class="line">            name = <span class="string">&quot;Júnior&quot;</span></span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Response.AsJson(response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Response <span class="title">Create</span>(<span class="params">AccountModel model</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        model.Id = <span class="keyword">new</span> Random().Next(<span class="number">1</span>, <span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> response = <span class="keyword">new</span></span><br><span class="line">        &#123;</span><br><span class="line">            id = model.Id</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Response.AsJson(response, HttpStatusCode.Created);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">AccountModel</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Devolvendo uma página HTML.<br>Para devolver uma página HTML, você precisa criar na raiz do projeto uma pasta chamada <strong>Views</strong>, e dentro dela, uma pasta com o nome igual a da sua rota.<br>No caso eu vou criar um módulo chamado <strong>DocModule</strong> e uma rota para <strong>doc</strong>, logo dentro da pasta <strong>Views</strong> eu vou criar uma pasta <strong>Doc</strong> e colocar o meu arquivo HTML lá dentro.<br>Abaixo o código para devolver o arquivo HTML para o navegador, note que o nome do arquivo que eu estou devolvendo é <strong>index.html</strong>, sendo assim, o nome do arquivo que eu vou criar precisa ser <strong>index.html</strong> também.</p><figure class="highlight csharp"><figcaption><span>DocModules.cs</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">DocModules</span> : <span class="title">NancyModule</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DocModules</span>()</span></span><br><span class="line"><span class="function">        : <span class="title">base</span>(<span class="params"><span class="string">&quot;doc&quot;</span></span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Get[<span class="string">&quot;/&quot;</span>] = _ =&gt; View[<span class="string">&quot;index.html&quot;</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Obrigado pela visita e até a próxima.</p></div></article><aside><div id="disqus_thread"></div><script type="text/javascript" async defer>var disqus_shortname="jroliveira";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}()</script><script id="dsq-count-scr" src="//jroliveira.disqus.com/count.js" async defer></script><noscript>Please enable JavaScript to view the <a target="_blank" href="https://disqus.com/?ref_noscript" rel="nofollow noopener">comments powered by Disqus.</a></noscript></aside></div></main><footer class="site-footer"><div class="page__container"><div class="row"><div class="six columns"><ul class="social-networks-list"><li class="social-network-item"><a href="//500px.com/jr_oliveira" target="_blank" rel="noopener"><img class="social-network-item__icon" src="/assets/images/social-networks/500px.svg" alt="Junior Oliveira's 500px"> <span class="social-network-item__name">500px.com/jr_oliveira</span></a></li><li class="social-network-item"><a href="//instagram.com/junr.oliveira" target="_blank" rel="noopener"><img class="social-network-item__icon" src="/assets/images/social-networks/instagram.svg" alt="Junior Oliveira's instagram"> <span class="social-network-item__name">instagram.com/junr.oliveira</span></a></li><li class="social-network-item"><a href="//twitter.com/junr_oliveira" target="_blank" rel="noopener"><img class="social-network-item__icon" src="/assets/images/social-networks/twitter.svg" alt="Junior Oliveira's twitter"> <span class="social-network-item__name">twitter.com/junr_oliveira</span></a></li><li class="social-network-item"><a href="//linkedin.com/in/junior-oliveira" target="_blank" rel="noopener"><img class="social-network-item__icon" src="/assets/images/social-networks/linkedin.svg" alt="Junior Oliveira's linkedin"> <span class="social-network-item__name">linkedin.com/in/junior-oliveira</span></a></li><li class="social-network-item"><a href="//github.com/jroliveira/" target="_blank" rel="noopener"><img class="social-network-item__icon" src="/assets/images/social-networks/github.svg" alt="Junior Oliveira's github"> <span class="social-network-item__name">github.com/jroliveira</span></a></li></ul></div><div class="six columns"><div class="tag-cloud"><a href="/tags/delphi/" title="8" style="font-size:112%">delphi</a> <a href="/tags/rtti/" title="2" style="font-size:88%">rtti</a> <a href="/tags/generics/" title="2" style="font-size:88%">generics</a> <a href="/tags/json/" title="3" style="font-size:92%">json</a> <a href="/tags/ux/" title="1" style="font-size:84%">ux</a> <a href="/tags/datasnap/" title="2" style="font-size:88%">datasnap</a> <a href="/tags/jquery/" title="1" style="font-size:84%">jquery</a> <a href="/tags/php/" title="1" style="font-size:84%">php</a> <a href="/tags/csharp/" title="10" style="font-size:120%">csharp</a> <a href="/tags/di/" title="2" style="font-size:88%">di</a> <a href="/tags/ioc/" title="2" style="font-size:88%">ioc</a> <a href="/tags/solid/" title="1" style="font-size:84%">solid</a> <a href="/tags/tdd/" title="2" style="font-size:88%">tdd</a> <a href="/tags/jekyll/" title="1" style="font-size:84%">jekyll</a> <a href="/tags/nhibernate/" title="1" style="font-size:84%">nhibernate</a> <a href="/tags/singleton/" title="1" style="font-size:84%">singleton</a> <a href="/tags/design-pattern/" title="1" style="font-size:84%">design-pattern</a> <a href="/tags/simpledata/" title="1" style="font-size:84%">simpledata</a> <a href="/tags/nancy/" title="1" style="font-size:84%">nancy</a></div></div></div></div></footer><noscript><p>Please enable JavaScript on your browser</p></noscript><script async defer type="text/javascript">"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js").catch(console.warn)</script></body></html>